"use strict";angular.module("fotbollskalendernWebApp",["ngRoute","ui.bootstrap","LocalStorageModule"]).value().config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/match",{templateUrl:"views/match.html",controller:"MatchCtrl"}).when("/team",{templateUrl:"views/team.html",controller:"TeamCtrl"}).otherwise({redirectTo:"/"})}]).filter("futureDates",function(){return function(a){for(var b=[],c=(new Date).getTime(),d=0;d<a.length;d++){var e=new Date(a[d].date).getTime();e>c&&b.push(a[d])}return b}}).filter("filterArray",function(){return function(a,b){for(var c=[],d=0;d<a.length;d++)-1!=b.indexOf(a[d].league)&&c.push(a[d]);return c}}),angular.module("fotbollskalendernWebApp").constant("Leagues",[{name:"Premier league",url:"mock_data/premierleague.json"},{name:"La liga",url:"mock_data/laliga.json"},{name:"Bundesliga",url:"mock_data/bundesliga.json"},{name:"Serie A",url:"mock_data/seriea.json"},{name:"Franskaligan",url:"mock_data/ligue1.json"},{name:"Hollänskaligan",url:"mock_data/holland.json"}]),angular.module("fotbollskalendernWebApp").controller("MainCtrl",["$scope","$location","matchService","Leagues","localStorageService",function(a,b,c,d,e){var f=function(b){c.getGamesByDate(b).then(function(c){a.allDays.push({date:b,games:c})})};a.clearLocalStorage=function(){e.clearAll(),console.log("Scope: "+a.filters),console.log("Local: "+e.get("savedFilters"))},a.filters=[],a.leagues=d,e.get("savedFilter")?(console.log("hittade local storage"),a.filters=e.get("savedFilter")):(console.log("hittade ingen local storage"),d.forEach(function(b){a.filters.push(b.name)}),e.set("savedFilter",a.filters)),a.allLeagues=d,a.allDays=[];for(var g=7,h=new Date,i={year:"numeric",month:"2-digit",day:"2-digit"},j=0;g>j;j++)f(h.toLocaleDateString("sv-SE",i)),h.setDate(h.getDate()+1);a.matchInfo=function(a){console.log(a.id),b.path("match").search("matchId",a.id)},a.filterMatch=function(b){-1!=a.filters.indexOf(b)?a.filters.splice(a.filters.indexOf(b),1):a.filters.push(b),console.log("skriver över local storage med "+a.filters),e.set("savedFilter",a.filters)}}]),angular.module("fotbollskalendernWebApp").controller("AboutCtrl",["$scope","matchService","$location","Leagues",function(a,b,c,d){var e=function(c){b.getGamesByDate(c).then(function(b){a.allDays.push({date:c,games:b})})};a.allLeagues=d,a.leagues=d,a.filters=[],d.forEach(function(b){a.filters.push(b.name)}),a.allDays=[];for(var f=30,g=new Date,h={year:"numeric",month:"2-digit",day:"2-digit"},i=0;f>i;i++)e(g.toLocaleDateString("sv-SE",h)),g.setDate(g.getDate()+1);a.matchInfo=function(a){console.log(a.id),c.path("match").search("matchId",a.id)},a.sortBy="time",a.filterMatch=function(b){-1!=a.filters.indexOf(b)?a.filters.splice(a.filters.indexOf(b),1):a.filters.push(b)}}]),angular.module("fotbollskalendernWebApp").controller("MatchCtrl",["$scope","matchService","$location","$http",function(a,b,c){a.id=c.search().matchId,a.match={},b.getGameById(a.id).then(function(b){a.match=b}),a.teamInfo=function(a){c.path("team").search("teamName",a)}}]),angular.module("fotbollskalendernWebApp").controller("TeamCtrl",["$scope","$location","teamService",function(a,b,c){a.team=b.search().teamName,a.games={},c.getGamesFromTeam(a.team).then(function(b){a.games=b}),a.matchInfo=function(a){console.log(a.id),b.path("match").search("matchId",a.id)}}]),angular.module("fotbollskalendernWebApp").directive("gamesList",function(){return{templateUrl:"scripts/directives/games-list.html",restrict:"E",scope:{games:"=",action:"=",includeDate:"=",day:"=",allDays:"="}}}),angular.module("fotbollskalendernWebApp").factory("matchService",["$http","$q","Leagues",function(a,b,c){var d=[];c.forEach(function(b){d.push(a.get(b.url))});var e=b.all(d);return{getGamesByDate:function(a){var d=[],f=b.defer();return e.then(function(b){b.forEach(function(b,e){var f=b.data,g=e;f.forEach(function(b){0===b.date.indexOf(a)&&d.push({game:b,league:c[g].name})})}),f.resolve(d)}),f.promise},getGameById:function(a){var c,d=b.defer();return e.then(function(b){b.forEach(function(b){var d=b.data;d.forEach(function(b){b.id===a&&(c=b)})}),d.resolve(c)}),d.promise}}}]),angular.module("fotbollskalendernWebApp").factory("teamService",["$http","$q",function(a,b){var c=b.all([a.get("mock_data/premierleague.json"),a.get("mock_data/bundesliga.json"),a.get("mock_data/holland.json"),a.get("mock_data/laliga.json"),a.get("mock_data/seriea.json"),a.get("mock_data/ligue1.json")]);return{getGamesFromTeam:function(a){var d=[],e=b.defer();return c.then(function(b){b.forEach(function(b){var c=b.data;c.forEach(function(b){(b.homeTeam===a||b.awayTeam===a)&&d.push(b)})}),e.resolve(d)}),e.promise}}}]);